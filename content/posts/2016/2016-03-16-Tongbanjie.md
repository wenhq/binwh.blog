---
title: 产品初探之十:铜板街用户资金流分析
slug: tongbanjie
date: 2016-03-16T18:01
description: 
author: wenhq
draft: false
share: true
---

由于工作需要，对铜板街App的用户资金流进行了一定的分析，目的是了解交易结构与资金流。
本文随着体验的进行会逐步进行完善。

## 1. 投资记录
铜板街主要产品为铜宝和其他定期项目。而投资定期项目可以使用账户余额，也可以使用铜宝余额。这就相当于用户用户资金账户和铜宝账户两个账户体系。当用户进行投资时就会出现两个账户交叉的情况。

下面两个图片为本人的真实投资记录：
![铜宝账单（3-16）](http://upload-images.jianshu.io/upload_images/30140-3e311a09f22d7be9?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)
![账户收支明细（3-16）](http://upload-images.jianshu.io/upload_images/30140-f87034e83f7fabc2?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

根据账户和铜宝的流水记录构建如下表格：

时间 | 行为 | 资金账户 | 铜宝账户
 -----|------|---- |------
2016-02-23 17:52|用户账户充值200元 | 200.00<br />(1602230000062071200101) | 0.00<br /> (-)
 2016-02-23 17:53 | 余额200元转入铜宝 | 0.00<br />(160223175331302150) | 200.00<br />(1602231753313799358315)
2016-03-15 20:59 | 用户账户充值800元 | 800.00<br />(1603150000107096200101) | 200.00<br /> (-)
2016-03-15 20:59 | 余额800元转入铜宝 | 0.00<br />(160315205948748460) | 1000.41<br />(1603152059488237998315)
2016-03-15 21:02|使用铜宝预约一铜天下1080期定期产品|0.00<br /> (-) |1000.41(锁定10000.00)<br />(1603152102102106240328315)
2016-03-15 22:19|用户账户充值100元|100.00<br /> (1603150000112420200101) |1000.41(锁定10000.00)<br /> (-) 
2016-03-16 00:45|铜宝收益0.1元|100.00<br />(-)| 1000.51(锁定10000.00)<br />(1603160045513480028315)
2016-03-16 08:00|**预约解锁并投资扣款**|1100.00<br /> (160316080005172743) <br />100.00<br />(160316080005172743)|1000.51(锁定0.00)<br /> (1603160800093738378315)<br />0.51<br />(1603160800093831668315)
2016-03-16 09:54|铜宝转出至账户|100.00<br />(-)|0.51(锁定0.51)<br />(1603160954507276138315)
2016-03-16 10:44|**银行卡转入铜宝**|200.00<br />(160316104435049738)<br />100.00<br />(160316104435049738)|100.51<br />(1603161044371714748315)

可以看到有些环节的资金流，看起来不是那么清楚。

## 2. 功能点的资金流说明
铜板街几个关键功能点如下：
1. 账户余额购买铜宝
- 银行卡购买铜宝（*）
- 铜宝预约定期产品（*）
- 直接使用铜宝购买定期产品
- 铜宝转出
- 定期产品到期
- 资金自动转入铜宝

目前的体验工作研究到前三个功能点，包括了两个难点。

### 2.1. 账户余额购买铜宝
资金从账户余额进入到铜宝，资金账户记录一笔支出，铜宝账户记录一笔收入。这里没有问题。
### 2.2. 银行卡购买铜宝（*）

时间 | 行为 | 资金账户 | 铜宝账户
 -----|------|---- |------
2016-03-16 10:44 | **银行卡转入铜宝** | 200.00<br />(160316104435049738)<br />100.00<br />(160316104435049738) | 100.51<br />(1603161044371714748315) 

从展示的资金记录上看，似乎不是银行卡的钱直接转入铜宝，而是先转入账户余额，再从账户余额转入铜宝。

这里出现问题，资金账户有两条记录使用同一个资金流水号，应该是铜板街自身系统设计的问题。这么看资金是直接进入铜宝，只是在资金账户里记录了一下资金的进出。

### 2.3. 铜宝预约定期产品（*）

时间 | 行为 | 资金账户 | 铜宝账户
 -----|------|---- |------
2016-03-16 08:00|**预约解锁并投资扣款**|1100.00<br /> (160316080005172743) <br />100.00<br />(160316080005172743)|1000.51(锁定0.00)<br /> (1603160800093738378315)<br />0.51<br />(1603160800093831668315)

预约转购买的流程更加复杂。从理解上应该是：
1. 铜宝里锁定的资金解除锁定（铜宝流水1603160800093738378315）
2. 解锁资金进入账户余额（铜宝流水1603160800093831668315）
3. 账户余额进账后再购买定期（账户资金流水160316080005172743）

和银行卡购买铜宝一样资金账户得两条资金记录流水号是一样的。实际上铜宝的资金直接划转用来购买定期，资金账户的一条流水用来做记录。

### 2.4. 资金流示意
根据我们的推测，可以画出铜板街用户层面的资金流图。绿色为活期相关资金流；蓝色为定期相关资金流。

![资金流图](http://upload-images.jianshu.io/upload_images/30140-aeda4cd41b867034.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/620)

而逻辑层面应该如下图所示：

![逻辑层面上的资金流](http://upload-images.jianshu.io/upload_images/30140-a3df803359181aa6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/620)
虚线表示资金应从用户平台的资金账户来实现平台产品的转入和转出。

## 3. 铜板街的其他说明
### 3.1. 铜宝的转入途径
铜宝可以使用账户余额转入，也可以使用银行卡转入
![转入途径](http://upload-images.jianshu.io/upload_images/30140-89939952e3370ea6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

### 3.2. 铜宝的转入途径的自动判断
当账户有钱的时候，默认是从账户转入
![账户有钱时](http://upload-images.jianshu.io/upload_images/30140-78feade68ed9d1a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)
这时可以选择使用银行卡
![可以选择使用银行卡](http://upload-images.jianshu.io/upload_images/30140-d894b99f170030ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

当账户没钱的时候，默认是从银行卡转入
![账户没钱时](http://upload-images.jianshu.io/upload_images/30140-6951941e3fff3391.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)
这时账户余额不足
![账户余额不足](http://upload-images.jianshu.io/upload_images/30140-c36ddf1f59402455.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

### 3.3. 铜宝的消费概念
使用铜宝购买定期是消费，以后户不会还有使用铜宝充话费还信用卡？
![铜宝账单的消费类别](http://upload-images.jianshu.io/upload_images/30140-aec1965b45c1c5b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

### 3.4. 铜宝第二次预约
预约过一个产品后，再次预约该产品。还没约满，不能再预约了；或者是铜板街看出我没钱了。
![坐等开售](http://upload-images.jianshu.io/upload_images/30140-3f028393e7b36f1b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

### 3.5. 铜宝的资金锁定状态
锁定状态有预约锁定和转出锁定。
![锁定状态](http://upload-images.jianshu.io/upload_images/30140-65336ee1f8b811f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

## 附：资金流水记录
- 2016年2月23日17点52分使用银行卡充值200元，账户余额变为200元，账户资金流水为1602230000062071200101。

- 2016年2月23日17点53分余额200元转入铜宝，账户余额变为0元，铜宝余额为200元，账户资金流水为160223175331302150，铜宝流水为1602231753313799358315。
![账户余额转入铜宝的详情](http://upload-images.jianshu.io/upload_images/30140-7062b15df6792d6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

- 2016年3月15日20点59分使用银行卡充值800元，账户余额变为800元，账户资金流水为1603150000107096200101。

- 2016年3月15日20点59分余额800元转入铜宝，账户余额变为0元，铜宝余额为1000.41元，账户资金流水为160315205948748460，铜宝流水为1603152059488237998315。铜宝多出的0.41元为2月23日至3月15日的利息。

- 2016年3月15日21点02分使用铜宝预约一铜天下1080期定期产品，铜宝余额为1000.41元，预约锁定1000元，铜宝流水为1603152102102106240328315。
![预约成功](http://upload-images.jianshu.io/upload_images/30140-bfaa4d2b50c9483b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)
![预约锁定详情](http://upload-images.jianshu.io/upload_images/30140-018b74c16453cae5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

- 2016年3月15日22点19分使用银行卡充值100元，账户余额变为100元，账户资金流水为1603150000112420200101。这笔资金用于自动转入测试和一些购买行为的测试。

- 2016年3月16日00点45分收到铜宝收益0.1元，铜宝余额为1000.51元，铜宝流水为1603160045513480028315。
![铜宝收益详情](http://upload-images.jianshu.io/upload_images/30140-602df528494d0115.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

- 2016年3月16日08点00分1000元锁定解除，铜宝余额为1000.51元，铜宝流水为1603160800093738378315。同时预约扣款1000元，铜宝余额为0.51元，铜宝流水为1603160800093831668315。
![铜宝锁定解除详情](http://upload-images.jianshu.io/upload_images/30140-8a946e964ce00aa7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

- 2016年3月16日08点00分铜宝转出1000元，账户余额为1100元，账户资金流水为160316080005172743。同时支出1000元购买一铜天下1080期，账户余额100元，账户资金流水仍为160316080005172743。

![铜宝转出到余额的明细](http://upload-images.jianshu.io/upload_images/30140-595a6792b79e2737.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

![支出购买定期](http://upload-images.jianshu.io/upload_images/30140-463f1178690f2045.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

- 2016年3月16日09点54分在铜宝发起转出0.51元到账户余额，铜宝余额0.51元，锁定0.51元，铜宝流水号为1603160954507276138315。
![T+1转出到账](http://upload-images.jianshu.io/upload_images/30140-1c73b3378cd5e74b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)
![铜宝转出锁定详情](http://upload-images.jianshu.io/upload_images/30140-488050a6c09fb60d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

- 2016年3月16日10点44分在铜宝使用银行卡转入100元，铜宝余额为100.51元，铜宝流水号为1603161044371714748315。

![银行卡转入铜宝的明细](http://upload-images.jianshu.io/upload_images/30140-abe3ce4d2f4173ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/240)

- 2016年3月16日10点44分账户充值100元用于购买铜宝，账户余额200元，账户资金流水为160316104435049738。同时支出100元购买铜宝，账户余额100元，账户资金流水仍为160316104435049738。

## 更新记录
2016-03-16 完成主要功能点资金流的研究